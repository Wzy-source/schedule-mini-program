(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{2349:function(t,e,n){},"4e7b":function(t,e,n){"use strict";(function(t){n("b483");a(n("66fd"));var e=a(n("869d"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"6f0d":function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}));var s=function(){var t=this,e=t.$createElement,n=(t._self._c,t.itemInfo.date.substring(5)),a=t.itemInfo.date.substring(5);t.$mp.data=Object.assign({},{$root:{g0:n,g1:a}})},o=[]},"7c13":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("e6d3")),s=o(n("e659"));o(n("66fd"));function o(t){return t&&t.__esModule?t:{default:t}}var i=function(){n.e("components/scheduleItem").then(function(){return resolve(n("94cd"))}.bind(null,n)).catch(n.oe)},r={components:{scheduleItem:i},data:function(){return{weekDayList:[{weekDay:"周一",date:"08-16"},{weekDay:"周二",date:"08-17"},{weekDay:"周三",date:"08-18"},{weekDay:"周四",date:"08-19"},{weekDay:"周五",date:"08-20"},{weekDay:"周六",date:"08-21"},{weekDay:"周日",date:"08-22"}],dayTimeList:[{start:"09:00",end:"10:00"},{start:"10:00",end:"11:00"},{start:"11:00",end:"12:00"},{start:"12:00",end:"13:00"},{start:"13:00",end:"14:00"},{start:"14:00",end:"15:00"},{start:"15:00",end:"16:00"},{start:"16:00",end:"17:00"},{start:"17:00",end:"18:00"},{start:"18:00",end:"19:00"},{start:"19:00",end:"20:00"}],isTeacher:t.getStorageSync("isTeacher"),weekSchedule:{},weekAppointment:{},totalList:[],weekDate:{},modalName:"",createPlace:"",createContent:"",itemInfo:{date:"",place:"",name:"",content:"",rowIndex:0,colIndex:0},showOptBtn:!1,animationData:{},startHourRange:[],startHourTxt:"请选择",endHourRange:[],endHourTxt:"请选择",startHourIndex:0,endHourIndex:0}},methods:{doInit:function(){var e=t.getStorageSync("avatarUrl"),n=t.getStorageSync("nickName"),a=t.getStorageSync("name");0===n.length||0===e.length||0===a.length?this.modalName="DialogModal1":(this.getAppointment(),this.getWeekSchedule())},hideModal:function(){this.modalName=null,this.startHourTxt="请选择",this.endHourTxt="请选择"},toLogin:function(){this.modalName=null,t.navigateTo({url:"../login/login"})},onClick:function(t,e){this.itemInfo=this.totalList[t][e],"none"!==this.itemInfo.type&&(this.modalName="clickEvent")},onLongPress:function(t,e){if(this.itemInfo=this.totalList[t][e],"none"===this.itemInfo.type){this.createPlace="",this.createContent="",this.startHourTxt="请选择",this.endHourTxt="请选择",this.modalName="longpressEvent";var n=parseInt(this.itemInfo.startTime.split(":")[0]);for(t=n;t<20;t++){var a=9===t?"09:00":t+":00";this.startHourRange.push(a)}}else this.isTeacher&&"teacher"===this.itemInfo.type&&(this.showOptBtn=!0)},getWeekSchedule:function(){var e=this;t.request({url:a.default+"schedule/getScheduleByDate?startDate=".concat(this.weekDate[1],"&endDate=").concat(this.weekDate[7]),success:function(t){console.log(t),e.weekSchedule=t.data,e.setTotalList()}})},getAppointment:function(){var e=this;t.request({url:a.default+"appointment/getAppointmentByDate?startDate=".concat(this.weekDate[1],"&endDate=").concat(this.weekDate[7]),success:function(t){e.weekAppointment={1:[{appointmentId:1,name:"王子悦",date:"2021-08-16",startTime:"18:00",endTime:"20:00",place:"办公室",content:"转专业资讯",other:"要拿电脑"}],2:[],3:[],4:[],5:[],6:[{appointmentId:2,name:"自玥玥",date:"2021-08-21",startTime:"09:00",endTime:"10:00",place:"办公室",content:"答疑",other:"要拿手机"},{appointmentId:3,name:"自越野",date:"2021-08-21",startTime:"11:00",endTime:"13:00",place:"食堂",content:"抄作业",other:"要拿作业本"}],7:[]}}})},setTotalList:function(){this.totalList=[];for(var t=[],e=[],n=1;n<=7;n++){for(var a=[],s=0;s<this.weekSchedule[n].length;s++)this.weekSchedule[n][s].type="teacher",this.weekSchedule[n][s].name="毕菲菲",a.push(this.weekSchedule[n][s]);for(var o=0;o<this.weekAppointment[n].length;o++)this.weekAppointment[n][o].type="student",a.push(this.weekAppointment[n][o]);e.push(a)}for(n=0;n<7;n++){var i=[];for(s=0;s<11;s++)i.push({date:this.weekDate[n+1],startTime:0===s?"09:00":s+9+":00",endTime:s+10+":00",type:"none"});t.push(i)}for(n=0;n<7;n++){var r=e[n];for(s=0;s<r.length;s++){var d=r[s],u=parseInt(d.startTime)-9,c=parseInt(d.endTime)-9;for(o=u;o<c;o++)delete t[n][o];t[n].splice(u,1,d)}}for(n=0;n<t.length;n++){var l=[];for(s=0;s<t[n].length;s++)void 0!==t[n][s]&&l.push(t[n][s]);this.totalList.push(l)}this.setHeight()},setWeekDate:function(){var t=(0,s.default)().format("E");this.weekDate={1:(0,s.default)().subtract(t-1,"days").format("YYYY-MM-DD"),2:(0,s.default)().subtract(t-2,"days").format("YYYY-MM-DD"),3:(0,s.default)().subtract(t-3,"days").format("YYYY-MM-DD"),4:(0,s.default)().subtract(t-4,"days").format("YYYY-MM-DD"),5:(0,s.default)().subtract(t-5,"days").format("YYYY-MM-DD"),6:(0,s.default)().subtract(t-6,"days").format("YYYY-MM-DD"),7:(0,s.default)().add(7-t,"days").format("YYYY-MM-DD")}},saveCurrentInfo:function(){this.modalName="";var e=this;"true"===this.isTeacher&&t.request({url:a.default+"schedule/create",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{date:this.itemInfo.date,startTime:this.startHourTxt,endTime:this.endHourTxt,place:this.createPlace,content:this.createContent},success:function(t){e.createPlace="",e.createContent="",e.startHourTxt="请选择",e.endHourTxt="请选择",e.doInit()}})},deleteItem:function(){this.modalName="confirmDelete"},confirmItem:function(){this.showOptBtn=!1},confirmDeleteItem:function(){var e=this;t.request({url:a.default+"schedule/delete",data:{scheduleId:this.itemInfo.scheduleId},method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.doInit(),e.hideModal(),e.showOptBtn=!1}})},setHeight:function(){for(var t=0;t<this.totalList.length;t++)for(var e=0;e<this.totalList[t].length;e++){var n=this.totalList[t][e].startTime,a=this.totalList[t][e].endTime,s=160*(parseInt(a.split(":")[0])-parseInt(n.split(":")[0]));this.totalList[t][e].height=s,this.totalList[t][e].rowIndex=t,this.totalList[t][e].colIndex=e}},startHourChange:function(t){var e=t.detail.value;this.startHourTxt=this.startHourRange[e];for(var n=parseInt(this.startHourTxt.split(":")[0]),a=n+1;a<=20;a++){var s=a+":00";this.endHourRange.push(s)}},endHourChange:function(t){var e=t.detail.value;this.endHourTxt=this.endHourRange[e]}},onLoad:function(){this.setWeekDate(),this.doInit()}};e.default=r}).call(this,n("543d")["default"])},"869d":function(t,e,n){"use strict";n.r(e);var a=n("6f0d"),s=n("f8b9");for(var o in s)"default"!==o&&function(t){n.d(e,t,(function(){return s[t]}))}(o);n("f11d");var i,r=n("f0c5"),d=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"c6361fb0",null,!1,a["a"],i);e["default"]=d.exports},f11d:function(t,e,n){"use strict";var a=n("2349"),s=n.n(a);s.a},f8b9:function(t,e,n){"use strict";n.r(e);var a=n("7c13"),s=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a}},[["4e7b","common/runtime","common/vendor"]]]);